

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Windows Registry &#8212; The Cyber Toolkit</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/.ipynb_checkpoints/custom-checkpoint.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=305129232"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', '305129232');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Goals/DFIR/WindowsRegistry';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Zimmerman" href="Zimmerman.html" />
    <link rel="prev" title="Windows Process" href="WindowsProcesses.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    The Cyber Toolkit
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Goals</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="DFIR_Home.html">Digital Forensics and Incident Response</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="KAPE.html">KAPE - Kroll Artifact Parser and Extractor</a></li>
<li class="toctree-l2"><a class="reference internal" href="Volatility.html">Volatility</a></li>
<li class="toctree-l2"><a class="reference internal" href="WindowsEventViewer.html">Event Viewer</a></li>
<li class="toctree-l2"><a class="reference internal" href="WindowsProcesses.html">Windows Process</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Windows Registry</a></li>
<li class="toctree-l2"><a class="reference internal" href="Zimmerman.html">Zimmerman</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../EDR/EDR_Home.html">Endpoint Detection &amp; Response</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../EDR/Splunk.html">Splunk</a></li>
<li class="toctree-l2"><a class="reference internal" href="../EDR/Yara.html">Yara</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../EDR/SysInternals/SysInternals_Home.html">SysInternals</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../EDR/SysInternals/FileAndDisk.html">File and Disk Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../EDR/SysInternals/Misc.html">Misc Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../EDR/SysInternals/ProcessUtils.html">Process Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../EDR/SysInternals/Sysmon.html">Sysmon</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../General/General_Home.html">General Education Topics</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../General/TheBasics/TheBasics_Home.html">The Basics</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../General/TheBasics/Attacks.html">Attacks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../General/TheBasics/Threats.html">Threats</a></li>
<li class="toctree-l3"><a class="reference internal" href="../General/TheBasics/Vulnerabilities.html">Vulnerabilities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../General/CiscoProgramming.html">Cisco Programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General/CyberChef.html">Cyberchef</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General/DHCP.html">DHCP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General/DNS.html">DNS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General/EmailProtocol.html">Email Protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General/FileTransfer.html">File Transfer to Machines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General/FTP.html">FTP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General/grep.html">Grep</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General/HTTP.html">HTTP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General/Kali.html">Kali</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General/Kerberos.html">Kerberos Attacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General/NFS.html">NFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General/OWASP10.html">OWASP Top 10 - 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General/OSquery.html">OS Query</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General/Passwords.html">Passwords</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General/PowerShell.html">PowerShell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General/SSH.html">SSH</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General/Telnet.html">Telnet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General/TheOSIModel.html">The OSI Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General/UploadVulns.html">Upload Vulnerabilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General/WindowsAD.html">Windows Active Directory</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../General/Frameworks/Frameworks_Home.html">Frameworks</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../General/Frameworks/MITRE_Home.html">Mitre</a></li>
<li class="toctree-l3"><a class="reference internal" href="../General/Frameworks/MITRE_ATT%26CK.html">Mitre ATT&amp;CK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../General/Frameworks/MITRE_CAR.html">MITRE CARs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../General/Frameworks/MITRE_Defend.html">MITRE Defend</a></li>
<li class="toctree-l3"><a class="reference internal" href="../General/Frameworks/MITRE_Engage.html">MITRE Engage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../General/Frameworks/Killchain_Home.html">Killchain Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../General/Frameworks/Killchain_InfoGathering.html">Killchain - Info Gathering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../General/Frameworks/Killchain_Weaponization.html">Killchain - Weaponization</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Hashes/Hashes_Home.html">Hashes</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Hashes/HashCat.html">Hashcat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Hashes/HashID.html">HashID</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Hashes/Hydra.html">Hydra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Hashes/John.html">John The Ripper</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../MalwareAnalysis/MalwareAnalysis_Home.html">Malware Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../MalwareAnalysis/OleTools.html">Oletools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../MalwareAnalysis/ReverseEngineering.html">Reverse Engineering</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../NetworkMonitoring/NetworkMonitoring_Home.html">Network Monitoring</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../NetworkMonitoring/Snort.html">Snort</a></li>
<li class="toctree-l2"><a class="reference internal" href="../NetworkMonitoring/TCPDump.html">TCPDump</a></li>
<li class="toctree-l2"><a class="reference internal" href="../NetworkMonitoring/Tshark.html">TShark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../NetworkMonitoring/Wireshark.html">Wireshark</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Purview/Purview_Home.html">Microsoft Purview</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Purview/CompliancePortal.html">Compliance Portal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Purview/InformationProtectionScanner.html">Information Protection Scanner</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Purview/IntegrationRuntime.html">Integration Runtime</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Purview/KQL.html">Kusto Query Language (KQL)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Purview/MS365Encryption.html">Microsoft 365 Encryption</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Purview/SensitivityLabels.html">Sensitivity Labels</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../RedTeam/RedTeam_Home.html">Red Teaming</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../RedTeam/Collection/Collection_Home.html">Collection_Home</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../RedTeam/Collection/Mimikatz.html">MimiKatz</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../RedTeam/CredentialAccess/CredentialAccess_Home.html">Credential Access</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../RedTeam/Discovery/Discovery_Home.html">Discovery Home</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../RedTeam/Discovery/Ettercap.html">Ettercap &amp; Bettercap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../RedTeam/Discovery/Impacket.html">Impacket</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../RedTeam/Execution/Execution_Home.html">Execution</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../RedTeam/Execution/Armitage.html">Armitage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../RedTeam/Execution/Metasploit.html">Metasploit Framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="../RedTeam/Execution/Msfvenom.html">Msfvenom</a></li>
<li class="toctree-l3"><a class="reference internal" href="../RedTeam/Execution/SearchSploit.html">Searchsploit</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../RedTeam/InitialAccess/InitialAccess_Home.html">Initial Access</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../RedTeam/InitialAccess/Netcat.html">Netcat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../RedTeam/InitialAccess/SocialEngineeringToolkit.html">Social Engineering Toolkit (SET)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../RedTeam/InitialAccess/StabiliseShell.html">Stabilising a shell</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../RedTeam/LateralMovement/LateralMovement_Home.html">Lateral Movement</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../RedTeam/LateralMovement/Kerbrute.html">Kerbrute</a></li>
<li class="toctree-l3"><a class="reference internal" href="../RedTeam/LateralMovement/Rubeus.html">Rubeus</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../RedTeam/Persistence/Persistence_Home.html">Persistence</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../RedTeam/PrivilegeEscalation/PrivilegeEscalation_Home.html">Privelige Escalation</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../RedTeam/PrivilegeEscalation/BloodHound.html">BloodHound</a></li>
<li class="toctree-l3"><a class="reference internal" href="../RedTeam/PrivilegeEscalation/Evil-WinRM.html">Evil-WinRM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../RedTeam/PrivilegeEscalation/LES.html">Linux Exploit Suggester</a></li>
<li class="toctree-l3"><a class="reference internal" href="../RedTeam/PrivilegeEscalation/LinEnum.html">LinEnum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../RedTeam/PrivilegeEscalation/LinPeas.html">LinPeas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../RedTeam/PrivilegeEscalation/LinuxFun.html">Linux Fun</a></li>
<li class="toctree-l3"><a class="reference internal" href="../RedTeam/PrivilegeEscalation/LinuxPrivEsc.html">Linux Privelige Escalation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../RedTeam/PrivilegeEscalation/Powerup.html">Powerup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../RedTeam/PrivilegeEscalation/WindowsFun.html">Windows ‘Fun’ Stuff</a></li>
<li class="toctree-l3"><a class="reference internal" href="../RedTeam/PrivilegeEscalation/WindowsPersistence.html">Windows Persistence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../RedTeam/PrivilegeEscalation/WindowsPrivEsc.html">Windows PrivEsc</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../RedTeam/Recon/Recon_Home.html">Recon</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../RedTeam/Recon/Maltego.html">Maltego</a></li>
<li class="toctree-l3"><a class="reference internal" href="../RedTeam/Recon/Nmap.html">Nmap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../RedTeam/Recon/Nping.html">Nping</a></li>
<li class="toctree-l3"><a class="reference internal" href="../RedTeam/Recon/Recon-ng.html">Recon-ng</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Steganography/Steganography_Home.html">Steganography</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Steganography/Binwalk.html">Binwalk</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ThreatIntelligence/ThreatIntelligence_Home.html">Threat Intelligence</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../VulnerabilityManagement/VulnerabilityManagement_Home.html">Vulnerability Management</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../VulnerabilityManagement/Nessus.html">Nessus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../VulnerabilityManagement/OpenVAS.html">OpenVAS</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../WebExploitation/WebExploitation_Home.html">Web Exploitation</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-21"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../WebExploitation/BurpSuite/BurpSuite_Home.html">Burp Suite</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-22"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../WebExploitation/BurpSuite/BurpIntruder.html">Burp Suite - Intruder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../WebExploitation/BurpSuite/BurpRepeater.html">Burp Suite - Repeater</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../WebExploitation/GoBuster.html">Gobuster</a></li>
<li class="toctree-l2"><a class="reference internal" href="../WebExploitation/LFI.html">LFI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../WebExploitation/Nikto.html">Nikto</a></li>
<li class="toctree-l2"><a class="reference internal" href="../WebExploitation/RequestForgery.html">Request Forgeries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../WebExploitation/SQLinjection.html">SQL Injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../WebExploitation/Wfuzz.html">WFUZZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../WebExploitation/XSS.html">XSS</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Home Lab Setup</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../HomeLab/HomeLab.html">HomeLab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HomeLab/BuildingSnort.html">Building Snort</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HomeLab/BuildingSnortv2.html">Building Snort V2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HomeLab/BuildingSplunk.html">Building Splunk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HomeLab/OpenKylin.html">OpenKylin</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">My Programs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../MyPrograms/MyPrograms.html">My Programs</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-23"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../MyPrograms/FileDownloader.html">File Downloader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../MyPrograms/WebBruteForce.html">Web Brute Force Program</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Other (Mainly things I still need to do...)</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Other/FormattingNotes.html">Formatting Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Other/ThingsToDo.html">Things to Do</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Other/CloudAzure.html">Cloud Providers - Azure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Other/CTFpages.html">CTF Links</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Practice Rooms</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../PracticeRooms/SideQuest2023.html">Advent Of Cyber Side Quest 2023</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-24"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../PracticeRooms/AoCsidequest/AoCsq1.html">Advent Of Cyber - Side Quest 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../PracticeRooms/AoCsidequest/AoCsq2.html">Advent Of Cyber - Side Quest 2</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../PracticeRooms/HoloLive/HoloLive.html">HoloLive</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-25"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../PracticeRooms/HoloLive/HoloLive_Task8.html">HoloLive Walkthrough - Task 8</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../PracticeRooms/HoloLive/HoloLive_Task9.html">HoloLive Walkthrough - Task 9</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../PracticeRooms/HoloLive/HoloLive_Task10.html">HoloLive Walkthrough - Task 10</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../PracticeRooms/KustoDetectiveAgency/Detective_S1_C0.html">Kusto Detective Agency Season 1 (Challenge 0)</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-26"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../PracticeRooms/KustoDetectiveAgency/Detective_S1_C1.html">Kusto Detective Agency Season 1 (Challenge 1)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../PracticeRooms/KustoDetectiveAgency/Detective_S1_C2.html">Kusto Detective Agency Season 1 (Challenge 2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../PracticeRooms/KustoDetectiveAgency/Detective_S1_C4.html">Kusto Detective Agency Season 1 (Challenge 4)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../PracticeRooms/KustoDetectiveAgency/Detective_S1_C5.html">Kusto Detective Agency Season 1 (Challenge 5)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../PracticeRooms/AgentSudo.html">Agent Sudo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PracticeRooms/MrRobot.html">Mr Robot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PracticeRooms/Terminator.html">Terminator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PracticeRooms/Overpass.html">Overpass</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PracticeRooms/LazyAdmin.html">LazyAdmin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PracticeRooms/Startup.html">Startup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PracticeRooms/Ninja.html">Ninja</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PracticeRooms/Lian_Yu.html">Lian_Yu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PracticeRooms/Tomghost.html">Tomghost</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PracticeRooms/Ignite.html">Ignite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PracticeRooms/Labtainers/Labtainers.html">Labtainers</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Goals/DFIR/WindowsRegistry.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Windows Registry</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hives">Hives</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hive-key-current-user-hkcu">Hive Key Current User (HKCU)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hive-key-users-hku">Hive Key Users (HKU)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hive-key-local-machine-hklm">Hive Key Local Machine (HKLM)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hive-key-classes-root-hkcr">Hive Key Classes Root (HKCR)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hive-key-current-config-hkcc">Hive Key Current Config (HKCC)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#amcache">AMCache</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wizard-tools-registry-extraction">Wizard Tools - Registry Extraction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#accessdata-registry-viewer-ftk">AccessData Registry Viewer (FTK)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#zimmerman-s-registry-explorer">Zimmerman’s Registry Explorer</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regripper">RegRipper</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interesting-locations">Interesting Locations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#os-details">OS Details</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#control-sets">Control Sets</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#network">Network</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#user-autostart">User Autostart</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#services">Services</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#user-info-users-list">User Info (Users List)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recent-files">Recent files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#open-save-dialogue-box-history">Open/Save Dialogue Box History</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#explorer-searches">Explorer Searches</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shellbags">Shellbags</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evidence-of-execution">Evidence of Execution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#user-assist">User Assist</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application-compatibility-cache-appcompatcache">Application Compatibility Cache (AppCompatCache)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">AMcache</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#background-activity-moderator-and-desktop-activity-moderator-bam-dam">Background Activity Moderator and Desktop Activity Moderator (BAM &amp; DAM)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#external-devices-usb">External Devices / USB</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="windows-registry">
<h1>Windows Registry<a class="headerlink" href="#windows-registry" title="Permalink to this heading">#</a></h1>
<p>The registry is where the current configuration of the Windows OS is kept. To view the registry, open regedit from the command prompt (or powershell). From here we can see the hives <br>
<img alt="EmptyRegistry.png" src="../../_images/EmptyRegistry.png" /></p>
<hr><section id="hives">
<h2>Hives<a class="headerlink" href="#hives" title="Permalink to this heading">#</a></h2>
<p>The ‘hives’ are where data is kept in the registry. Each has a specific purpose and is normally referred to by it’s abbreviation. Each hive is stored in separate, hidden &amp; protected files -&gt; you cant open these directly from the OS except for via internal OS calls (such as those used by the registry editor). You can’t copy them either. They also don’t normally have file extensions (NTUSER and USRCLASS are the exceptions as .dat files). <br>
Various DFIR tools can extract the files from disk in both live and offline modes using wizardry, which we’ll get to later.<br>
Changes to the hives (transaction logs which have not yet been written to the live files) are kept in the same directories as .LOG files. Multiple files are sequential i.e. .LOG1,.LOG2,.LOG3 etc etc</p>
<section id="hive-key-current-user-hkcu">
<h3>Hive Key Current User (HKCU)<a class="headerlink" href="#hive-key-current-user-hkcu" title="Permalink to this heading">#</a></h3>
<p>When a user logs in (or is switched to), their NTUSER.dat file is loaded to the registry here.<br>
A user’s NTUSER.dat file is kept in C:\Users\[username]\<br>
The subkey HKCU/software/classes is kept in C:\Users\[username]\AppData\Local\Microsoft\Windows\USRCLASS.dat<br></p>
</section>
<section id="hive-key-users-hku">
<h3>Hive Key Users (HKU)<a class="headerlink" href="#hive-key-users-hku" title="Permalink to this heading">#</a></h3>
<p>This is the hive where all users are stored<br>
There is also a ‘default’ user kept.<br>
The default user’s file is in C:\Windows\System32\Config\DEFAULT<br></p>
</section>
<section id="hive-key-local-machine-hklm">
<h3>Hive Key Local Machine (HKLM)<a class="headerlink" href="#hive-key-local-machine-hklm" title="Permalink to this heading">#</a></h3>
<p>These are the settings of the computer, and is also used for a ‘default’ setting for users. The subkeys of HKLM are stored in separate files<br></p>
<blockquote>
<div><p>SAM (HKLM/SAM) -&gt; C:\Windows\System32\Config\SAM<br>
Security (HKLM/Security) -&gt; C:\Windows\System32\Config\SECURITY<br>
Software (HKLM/Software) -&gt; C:\Windows\System32\Config\SOFTWARE<br>
System (HKLM/System) -&gt; C:\Windows\System32\Config\SYSTEM.<br></p>
</div></blockquote>
</section>
<section id="hive-key-classes-root-hkcr">
<h3>Hive Key Classes Root (HKCR)<a class="headerlink" href="#hive-key-classes-root-hkcr" title="Permalink to this heading">#</a></h3>
<p>HKCR is a subkey of HKLM/software. This hive defines what file types launch which programs (such as a .txt opening in notepad). It is a merge of two other keys in order to find the ‘superseding’ value. These keys are: <br></p>
<blockquote>
<div><p>HKLM/software/classes <br>
HKCU/software/classes <br></p>
</div></blockquote>
<p>As above, HKLM is the ‘default’ value, where HKCU can override this. Therefore if a value exists in both, HKCU will take precedence. In a similar vein, if you write to HKCR, it will write to HKCU if it exists, otherwise it will write to HKLM.<br></p>
</section>
<section id="hive-key-current-config-hkcc">
<h3>Hive Key Current Config (HKCC)<a class="headerlink" href="#hive-key-current-config-hkcc" title="Permalink to this heading">#</a></h3>
<p>This is where the current hardware profile of the device is kept.<br></p>
</section>
<section id="amcache">
<h3>AMCache<a class="headerlink" href="#amcache" title="Permalink to this heading">#</a></h3>
<p>The AMCache isn’t displayed in the registry editor but it is stored as a .hve file. The AMcache stores recently run programs, making it a great location for DFIR.<br>
The AMCache is in C:\Windows\AppCompat\programs\amcache.hve<br></p>
<hr></section>
</section>
<section id="wizard-tools-registry-extraction">
<h2>Wizard Tools - Registry Extraction<a class="headerlink" href="#wizard-tools-registry-extraction" title="Permalink to this heading">#</a></h2>
<p>As mentioned in the last section, you can’t just copy or open the registry hives without special tools. In a live system that tool is regedit, but what are you going to do if you only have a disk image? You also can’t just go logging in to a suspicious machine as you may overwrite or modify key artifacts. So what is an investigator to do?<br></p>
<section id="accessdata-registry-viewer-ftk">
<h3>AccessData Registry Viewer (FTK)<a class="headerlink" href="#accessdata-registry-viewer-ftk" title="Permalink to this heading">#</a></h3>
<p>This one is a bit of a red herring - Access data doesnt exit any more. They appear to have been brought out by Exterro and have rebranded to FTK and don’t have a free option any more… Booo.<br>
Not the end of the world, they were quite limited anyways. They can be found here: <a class="reference external" href="https://www.exterro.com/">https://www.exterro.com/</a> <br></p>
<blockquote>
<div><p>Can only view one hive at a time (offline) <br>
Can’t bring in transaction logs <br></p>
</div></blockquote>
<p>Full disclosure, I haven’t dived into this one yet, it’s perfectly possible that FTK has more features.</p>
</section>
<section id="zimmerman-s-registry-explorer">
<h3>Zimmerman’s Registry Explorer<a class="headerlink" href="#zimmerman-s-registry-explorer" title="Permalink to this heading">#</a></h3>
<p>(Eric) Zimmerman will come up quite a bit in our DFIR journey, he’s the OG wizard for this sorta stuff. You can find his tools here: <a class="reference external" href="https://ericzimmerman.github.io/#!index.md">https://ericzimmerman.github.io/#!index.md</a> <br>
Registry Explorer has all the features we would expect<br></p>
<blockquote>
<div><p>Load multiple hives at once<br>
Load Transaction logs and reconcile against the loaded hive<br></p>
</div></blockquote>
</section>
<section id="regripper">
<h3>RegRipper<a class="headerlink" href="#regripper" title="Permalink to this heading">#</a></h3>
<p>I love the ‘Ripper’ name, goes back to the ‘warez’ days for me. Anyways, Regripper doesnt extract from the registry but it can build a report from a loaded hive. It can’t however load transaction logs so must be used after other tools <em>cough</em> Registry Explorer <em>cough</em>.</p>
<hr></section>
</section>
<section id="interesting-locations">
<h2>Interesting Locations<a class="headerlink" href="#interesting-locations" title="Permalink to this heading">#</a></h2>
<p>This section simply lists where to find some interesting data to help with an investigation. There’s far more to it but I use it as a quick reference check; it’s also great for getting a bit of background on your device<br></p>
<section id="os-details">
<h3>OS Details<a class="headerlink" href="#os-details" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>OS Version -&gt; HKLM/Software/Microsoft/WindowsNT/CurrentVersion <br>
Computer Name -&gt; HKLM/System/CurrentControlSet/Control/ComputerName/ComputerName <br>
Time Zone -&gt; HKLM/System/CurrentControlSet/Control/TimeZoneInformation</p>
</div></blockquote>
</section>
<section id="control-sets">
<h3>Control Sets<a class="headerlink" href="#control-sets" title="Permalink to this heading">#</a></h3>
<p>Note: The “Active Control Sets” supersedes the below, it’s the actual setting (not just default as below)<br></p>
<blockquote>
<div><p>Volatile Control Set -&gt; HKLM/System/CurrentControlSet<br>
Active Control Sets -&gt; HKLM/System/Select<br>
Booted Control Set -&gt; HKLM/System/ControlSet001<br>
Last known Good Set -&gt; HKLM/System/ControlSet002<br></p>
</div></blockquote>
</section>
<section id="network">
<h3>Network<a class="headerlink" href="#network" title="Permalink to this heading">#</a></h3>
<p>I’m still not sure what Managed vs unmanaged signatures are. Best I can tell is that ‘Managed’ are provided by a DNS server where ‘Unmanaged’ are wireless networks or uncontrolled ‘wired’ connections. Would love to know the answer if anyone knows…. <br></p>
<blockquote>
<div><p>Interfaces -&gt; HKLM/System/CurrentControlSet/Services/TCPIP/Paramaters/Interfaces<br>
Past Networks -&gt; HKLM/Software/Microsoft/WindowsNT/CurrentVersion/NetworkList/Signatures/managed or unmanaged<br></p>
</div></blockquote>
</section>
<section id="user-autostart">
<h3>User Autostart<a class="headerlink" href="#user-autostart" title="Permalink to this heading">#</a></h3>
<p>As above when the hives were mentioned, HKCU can override HKLM. The first two below are in both hives (at the same location) where HKCU will supersede HKLM.<br></p>
<blockquote>
<div><p>Every Login -&gt; HIVE/Software/Microsoft/Windows/CurrentVersion/Run <br>
Once off -&gt; HIVE/Software/Microsoft/Windows/CurrentVersion/RunOnce <br>
HKLM/software/Microsoft/Windows/CurrentVersion/Policies/Explorer/run <br></p>
</div></blockquote>
</section>
<section id="services">
<h3>Services<a class="headerlink" href="#services" title="Permalink to this heading">#</a></h3>
<p>If a service ‘start’ is 0x02 then it is autostart on boot.<br></p>
<blockquote>
<div><p>Registered Services -&gt; HKLM/System/CurrentControlSet/Services/<br></p>
</div></blockquote>
</section>
<section id="user-info-users-list">
<h3>User Info (Users List)<a class="headerlink" href="#user-info-users-list" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>HKLM/SAM/Domains/Accounts/Users<br></p>
</div></blockquote>
</section>
<section id="recent-files">
<h3>Recent files<a class="headerlink" href="#recent-files" title="Permalink to this heading">#</a></h3>
<p>These are the files recently accessed by the user account. It only includes those accessed by ‘explorer’ and stores the name in hex (open the binary string to see it decoded, or use your tool of choice) <br></p>
<blockquote>
<div><p>HKCU/Software/Microsoft/Windows/CurrentVersion/Explorer/RecentDocs<br>
There is also .[ext] subkeys for each extension <br></p>
</div></blockquote>
<p>MS office keeps it’s own ‘recent files too <br></p>
<blockquote>
<div><p>HKCU/Software/Microsoft/Office/[version]/[application]/ <br>
If looking for Office365, this is in \userMRU\LiveID_####\FileMRU <br></p>
</div></blockquote>
</section>
<section id="open-save-dialogue-box-history">
<h3>Open/Save Dialogue Box History<a class="headerlink" href="#open-save-dialogue-box-history" title="Permalink to this heading">#</a></h3>
<p>This is one that I didnt think of until I heard about it. This is where the OS stores the location for the ‘default’ window when you try to save a new file (or open a new file). There are plenty of subkeys here (including specific file extensions under /OpenSavePidMRU/). <br></p>
<blockquote>
<div><p>HKCU/Software/Microsoft/Windows/CurrentVersion/Explorer/ComDlg</p>
</div></blockquote>
</section>
<section id="explorer-searches">
<h3>Explorer Searches<a class="headerlink" href="#explorer-searches" title="Permalink to this heading">#</a></h3>
<p>This is the search history from the ‘search’ bar in explorer. <br></p>
<blockquote>
<div><p>HKCU/Software/Microsoft/Windows/CurrentVersion/Explorer/TypedPaths <br>
HKCU/Software/Microsoft/Windows/CurrentVersion/Explorer/WordWheelQuery <br></p>
</div></blockquote>
</section>
<section id="shellbags">
<h3>Shellbags<a class="headerlink" href="#shellbags" title="Permalink to this heading">#</a></h3>
<p>Shellbacks aren’t ‘readable’ in the registry, you’ll need to use one of Zimmerman’s tools to inspect these -&gt; ShellBag Explorer <br></p>
<blockquote>
<div><p>HKCU/Software/Classes/Local Settings/Software/Microsoft/Windows/Shell/Bags/<br>
HKCU/Software/Classes/Local Settings/Software/Microsoft/Windows/Shell/Bags/BagMRU<br>
HKCU/Software/Microsoft/Windows/Shell/Bags<br>
HKCU/Software/Microsoft/Windows/Shell/BagMRU<br></p>
</div></blockquote>
<hr></section>
</section>
<section id="evidence-of-execution">
<h2>Evidence of Execution<a class="headerlink" href="#evidence-of-execution" title="Permalink to this heading">#</a></h2>
<p>While we have gone through what the registry is, and some interesting locations to investigate, these are only guides more than actual evidence. This chapter focuses on those areas where we can prove something happened. Think of the previous section as “someone looking around” and this one as “someone doing something”.<br></p>
<section id="user-assist">
<h3>User Assist<a class="headerlink" href="#user-assist" title="Permalink to this heading">#</a></h3>
<p>This is an interesting one, where the OS keeps a record of the .exe files run, how many times they have been run &amp; the ‘focus time’. The data is stored against a GUID and encoded (ROT13, surprised about that one). This is also only those run from the Explorer GUI, nothing from cmd or powershell here. <br></p>
<blockquote>
<div><p>HKCU/Software/Microsoft/Windows/CurrentVersion/Explorer/UserAssist/[UserGuid]/count <br></p>
</div></blockquote>
</section>
<section id="application-compatibility-cache-appcompatcache">
<h3>Application Compatibility Cache (AppCompatCache)<a class="headerlink" href="#application-compatibility-cache-appcompatcache" title="Permalink to this heading">#</a></h3>
<p>The AppCompatCache isnt readable directly in the registry and will need to be parsed. Again, we’re looking for at Zimmerman’s help on this one -&gt; AppCmpatCacheParser. To extract <br></p>
<blockquote>
<div><p>AppCompatCacheParser.exe –csv [outputfile] -f [hiveFile] -c [ControlSet] <br>
You can then view the .csv output in EZviewer<br></p>
</div></blockquote>
<p>The Hive is HKLM, full path below<br></p>
<blockquote>
<div><p>HKLM/System/CurrentControlSet/Control/Session Manager/AppCompatCache/ <br></p>
</div></blockquote>
</section>
<section id="id1">
<h3>AMcache<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<p>As we’ve been through already, the AMcache is a hive but it isn’t in RegEdit. It stores the last execututed programs and it is kept in <br></p>
<blockquote>
<div><p>C:\Windows\AppCompat\Programs\AMcache.hve <br></p>
</div></blockquote>
<p>In the hive, you can find the recent executions in <br></p>
<blockquote>
<div><p>root/file/[VolumeGUID]/<br></p>
</div></blockquote>
</section>
<section id="background-activity-moderator-and-desktop-activity-moderator-bam-dam">
<h3>Background Activity Moderator and Desktop Activity Moderator (BAM &amp; DAM)<a class="headerlink" href="#background-activity-moderator-and-desktop-activity-moderator-bam-dam" title="Permalink to this heading">#</a></h3>
<p>Both of these files store the same information, they are recently executed files in the background (BAM) and Desktop (DAM). Theres more to it than this though. The BAM is as above, where it monitors the launched applications at boot. The DAM on the other hand is designed to manage the battery usage by applications that use ‘Connected Standby’ on mobile &amp; tablet devices. Desktops won’t be populated.<br></p>
<blockquote>
<div><p>BAM -&gt; HKLM/System/CurrentControlSet/Services/bam/State/UserSettings/[UserGUID]/ <br>
DAM -&gt; HKLM/System/CurrentControlSet/Services/dam/State/UserSettings/[UserGUID]/ <br></p>
</div></blockquote>
</section>
<section id="external-devices-usb">
<h3>External Devices / USB<a class="headerlink" href="#external-devices-usb" title="Permalink to this heading">#</a></h3>
<p>Not evidence of execution as such, but evidence of device connection. USBs are a common way to bypass controls for file transfer, so connected devices are always a good source of information. <br>
To identify devices <br></p>
<blockquote>
<div><p>HKLM/System/CurrentControlSet/Enum/USB<br>
HKLM/System/CurrentControlSet/Enum/USBSTOR<br></p>
</div></blockquote>
<p>To find the ‘Friendly Name’ of the device (the device Label) match the “Identification” (USBSTOR) to the “Friendly Name” in <br></p>
<blockquote>
<div><p>HKLM/Software/Microsoft/Windows Portable Devices/Devices <br></p>
</div></blockquote>
<p>To find when the USB was connected to the device, see the below location. Note that the ‘Properties’ key is locked in a live OS so you can’t see it in Registry Editor. <br></p>
<blockquote>
<div><p>HKLM/System/CurrentControlSet/Enum/USBSTOR/Ven_[ModelProdVersion]/[USBserial]/properties/{[83_XXXXXX]}/NNNN<br>
NNNN = 0064 -&gt; First Connection<br>
NNNN = 0066 -&gt; Last Connection<br>
NNNN = 0067 -&gt; Last Disconnect<br></p>
</div></blockquote>
<p>The 83_XXX is specific to the hardware. <br></p>
<hr></section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Goals\DFIR"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="WindowsProcesses.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Windows Process</p>
      </div>
    </a>
    <a class="right-next"
       href="Zimmerman.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Zimmerman</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hives">Hives</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hive-key-current-user-hkcu">Hive Key Current User (HKCU)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hive-key-users-hku">Hive Key Users (HKU)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hive-key-local-machine-hklm">Hive Key Local Machine (HKLM)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hive-key-classes-root-hkcr">Hive Key Classes Root (HKCR)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hive-key-current-config-hkcc">Hive Key Current Config (HKCC)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#amcache">AMCache</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wizard-tools-registry-extraction">Wizard Tools - Registry Extraction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#accessdata-registry-viewer-ftk">AccessData Registry Viewer (FTK)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#zimmerman-s-registry-explorer">Zimmerman’s Registry Explorer</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regripper">RegRipper</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interesting-locations">Interesting Locations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#os-details">OS Details</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#control-sets">Control Sets</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#network">Network</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#user-autostart">User Autostart</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#services">Services</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#user-info-users-list">User Info (Users List)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recent-files">Recent files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#open-save-dialogue-box-history">Open/Save Dialogue Box History</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#explorer-searches">Explorer Searches</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shellbags">Shellbags</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evidence-of-execution">Evidence of Execution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#user-assist">User Assist</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application-compatibility-cache-appcompatcache">Application Compatibility Cache (AppCompatCache)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">AMcache</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#background-activity-moderator-and-desktop-activity-moderator-bam-dam">Background Activity Moderator and Desktop Activity Moderator (BAM &amp; DAM)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#external-devices-usb">External Devices / USB</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Paul Williams
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>